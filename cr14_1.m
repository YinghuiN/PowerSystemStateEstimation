%--------------------------------------------------------------------------------%
%                                   bus data
%  bus_i type	Pd	  Qd	Gs	Bs area  Vm	     Va	    baseKV	zone Vmax   Vmin
%---------------------------------------------------------------------------- ---%
%% 节点参数矩阵
bus = [
    1	  3	    0	  0	    0	0	1	 1.06	 0	     0	    1	 1.06	0.94	
    2	  2	    21.7  12.7	0	0	1	 1.045	 -4.98	 0      1	 1.06	0.94	
    3	  2	    94.2  19	0	0	1	 1.01	 -12.72	 0      1	 1.06	0.94	
    4	  1	    47.8  -3.9	0	0	1	 1.019	 -10.33	 0      1	 1.06	0.94	
    5	  1	    7.6	  1.6	0	0	1	 1.02	 -8.78	 0      1	 1.06	0.94	
    6	  2	    11.2  7.5	0	0	1	 1.07	 -14.22	 0      1	 1.06	0.94	
    7	  1	    0	  0	    0	0	1	 1.062	 -13.37	 0      1	 1.06	0.94	
    8	  2	    0	  0	    0	0	1	 1.09	 -13.36	 0      1	 1.06	0.94	
    9	  1	    29.5  16.6	0	19	1	 1.056	 -14.94	 0      1	 1.06	0.94	
    10	  1	    9	  5.8	0	0	1	 1.051	 -15.1	 0      1	 1.06	0.94	
    11	  1	    3.5	  1.8	0	0	1	 1.057	 -14.79	 0      1	 1.06	0.94	
    12	  1	    6.1	  1.6	0	0	1	 1.055	 -15.07	 0      1	 1.06	0.94	
    13	  1	    13.5  5.8	0	0	1	 1.05	 -15.16	 0      1	 1.06	0.94	
    14	  1	    14.9  5	    0	0	1	 1.036	 -16.04	 0      1	 1.06	0.94	
];
%-------------------------------------------------------------------------------------------------%
%                                        branch data
%	fbus tbus    r	      x	       b	 rateA	rateB  rateC  ratio	angle  status  angmin  angmax
%-------------------------------------------------------------------------------------------------%
%% 支路参数矩阵
branch = [
    1	 2	  0.01938	0.05917	 0.0528	 0	    0	   0	  0	    0	   1	   -360	   360	
    1	 5	  0.05403	0.22304	 0.0492	 0	    0	   0	  0	    0	   1	   -360	   360	
    2	 3    0.04699	0.19797	 0.0438	 0	    0	   0	  0	    0	   1	   -360	   360	
    2	 4	  0.05811	0.17632	 0.034	 0	    0	   0	  0	    0	   1	   -360	   360	
    2	 5	  0.05695	0.17388	 0.0346	 0	    0	   0	  0	    0	   1	   -360	   360	
    3	 4	  0.06701	0.17103	 0.0128	 0	    0	   0	  0	    0	   1	   -360	   360	
    4	 5	  0.01335	0.04211	 0       0	    0	   0	  0	    0	   1	   -360	   360	
    6	 11	  0.09498	0.1989	 0	     0	    0	   0	  0	    0	   1	   -360	   360	
    6	 12	  0.12291	0.25581	 0	     0	    0	   0	  0	    0	   1	   -360	   360	
    6	 13	  0.06615	0.13027	 0	     0	    0	   0	  0	    0	   1       -360	   360	
    7	 8	  0	        0.17615	 0	     0	    0	   0	  0	    0	   1	   -360	   360	
    7	 9	  0	        0.11001	 0	     0	    0	   0	  0	    0	   1	   -360	   360	
    9	 10	  0.03181	0.0845	 0	     0	    0	   0	  0	    0	   1	   -360	   360	
    9	 14	  0.12711	0.27038	 0	     0	    0	   0	  0	    0	   1	   -360	   360	
    10	 11	  0.08205	0.19207	 0	     0	    0	   0	  0	    0	   1	   -360	   360	
    12	 13	  0.22092	0.19988	 0	     0	    0	   0	  0	    0	   1	   -360	   360	
    13	 14	  0.17093	0.34802	 0	     0	    0	   0	  0	    0	   1	   -360	   360	
    4	 7	  0	        0.20912	 0	     0	    0	   0	  0.978	0	   1	   -360	   360	
    4	 9	  0	        0.55618	 0	     0	    0	   0	  0.969	0	   1	   -360	   360	
    5	 6	  0	        0.25202	 0	     0	    0	   0	  0.932	0	   1	   -360	   360	
];
%--------------------------------------------------------------------------------%
%                                       mdata
% mtype mdata     merror          mtrue        weight    fbus    tbus    m_num
%--------------------------------------------------------------------------------%
%% 量测参数矩阵
mdata = [
    1	2.32473	   0.000793456	  2.32393      1e+06	 1       1       1	
    1	0.18444	   0.00144018	  0.183        1e+06     2       2       2	
    1	-0.941515  0.000484937	  -0.942       1e+06     3       3       3	
    1	-0.476733  0.00126749	  -0.478       1e+06     4       4       4	
    1	-0.0765667 -0.000566714	  -0.076       1e+06     5       5       5	
    1	-0.11152   0.000480496	  -0.112       1e+06     6       6       6	
    1	-0.296339  -0.00133867	  -0.295       1e+06     9       9       9	
    1	-0.090171  -0.000171027	  -0.09        1e+06     10      10      10	
    1	-0.0359232 -0.000923152	  -0.035       1e+06     11      11  	 11	
    1	-0.0628607 -0.00186065	  -0.061       1e+06     12      12  	 12	
    1	-0.134563  0.000436535	  -0.135       1e+06     13      13  	 13	
    1	-0.148715  0.000285355	  -0.149       1e+06     14      14      14	
    2	-0.166242  -0.000749083	  -0.165493	   1e+06     1       1       1	
    2	0.309333   0.00076217	  0.308571	   1e+06     2       2       2	
    2	0.0633032  0.00254967	  0.0607535	   1e+06     3       3   	 3	
    2	0.0384413  -0.000558731	  0.039        1e+06     4       4   	 4	
    2	-0.0162029 -0.000202877	  -0.016       1e+06     5       5   	 5	
    2	0.0524482  0.000138759	  0.0523094	   1e+06     6       6       6	
    2	0.177191   0.000956921	  0.176235	   1e+06     8       8   	 8	
    2	-0.166502  -0.000501697	  -0.166       1e+06     9       9     	 9	
    2	-0.0587509 -0.000750889	  -0.058       1e+06     10      10  	 10	
    2	-0.0202911 -0.00229114	  -0.018       1e+06     11      11      11	
    2	-0.0162807 -0.000280726	  -0.016       1e+06     12      12      12	
    2	-0.0574153 0.000584744	  -0.058       1e+06     13      13      13	
    2	-0.0512603 -0.00126028	  -0.05        1e+06     14      14      14	
    0	1.0577	   -0.00230419	  1.06         1e+06     1       1       1	
    0	1.04252	   -0.00248417	  1.045        1e+06     2       2       2	
    0	1.0104	   0.000403202	  1.01         1e+06     3       3       3	
    0	1.01827	   0.000602682	  1.01767      1e+06     4       4       4	
    0	1.0189	   -0.000612353	  1.01951      1e+06     5       5       5	
    0	1.07034	   0.000342592	  1.07         1e+06 	 6       6       6	
    0	1.06118	   -0.000342214	  1.06152      1e+06     7       7       7	
    0	1.09073	   0.000731168	  1.09         1e+06     8       8       8	
    0	1.05595	   2.08297e-05	  1.05593      1e+06     9       9       9	
    0	1.05071	   -0.00027061	  1.05098      1e+06     10      10      10	
    0	1.05756	   0.000655183	  1.05691      1e+06     11      11      11	
    0	1.05595	   0.000761152	  1.05519      1e+06     12      12      12	
    0	1.05241	   0.0020302	  1.05038      1e+06     13      13      13	
    0	1.03614	   0.000614714	  1.03553      1e+06     14      14      14	
    3	1.57007	   0.0012394	  1.56883      1e+06 	 1       2       1	
    4	-0.202967  0.00107616	  -0.204043	   1e+06     1       2       1	
    -3	-1.52443   0.00142529	  -1.52585	   1e+06     1       2       1	
    -4	0.277316   0.000553559	  0.276762	   1e+06     1   	 2       1	
    3	0.756467   0.00136302	  0.755104	   1e+06     1       5   	 2	
    4	0.0382655  -0.000284437	  0.0385499	   1e+06     1       5       2	
    -3	-0.727337  0.000137598	  -0.727475	   1e+06     1   	 5       2	
    -4	0.022072   -0.000221554	  0.0222936	   1e+06     1       5       2	
    3	0.732601   0.000225119	  0.732376	   1e+06 	 2       3       3	
    4	0.0376684  0.0020664	  0.035602	   1e+06     2   	 3       3	
    -3	-0.7106    -0.00145657	  -0.709143	   1e+06     2       3       3	
    -4	0.0178143  0.001792	      0.0160223    1e+06     2       3       3	
    3	0.560094   -0.00122073	  0.561315	   1e+06     2       4       4	
    4	-0.0160022 -0.000498701	  -0.0155035   1e+06     2       4       4	
    -3	-0.545348  -0.000799531	  -0.544548	   1e+06     2       4       4	
    -4	0.0298498  -0.00035711	  0.0302069	   1e+06 	 2   	 4       4	
    3	0.415406   0.000243829	  0.415162	   1e+06     2       5       5	
    4	0.0115765  -0.00013348	  0.01171      1e+06     2       5   	 5	
    -3	-0.404565  0.00155956	  -0.406125	   1e+06     2       5   	 5	
    -4	-0.020558  0.000432325	  -0.0209903   1e+06     2       5       5	
    3	-0.233044  -0.000186774	  -0.232857	   1e+06     3       4   	 6	
    4	0.0441255  -0.000605612	  0.0447312	   1e+06     3       4       6	
    -3	0.237038   0.000446916	  0.236591	   1e+06     3       4       6	
    -4	-0.0489803 -0.000623768	  -0.0483565   1e+06     3       4   	 6	
    3	-0.611118  0.000464582	  -0.611582	   1e+06     4       5       7	
    4	0.159015   0.000778483	  0.158236	   1e+06     4       5       7	
    -3	0.615359   -0.00136792	  0.616727	   1e+06     4       5       7	
    -4	-0.142699  -0.000689286	  -0.14201	   1e+06     4       5       7	
    3	0.0751324  0.00159962	  0.0735328	   1e+06     6       11      8	
    4	0.03507	   -0.000534695	  0.0356047	   1e+06     6       11      8	
    -3	-0.0737489 -0.000769825	  -0.072979	   1e+06     6       11      8	
    -4	-0.0339063 0.000538884	  -0.0344451   1e+06 	 6       11      8	
    3	0.0791492  0.00128849	  0.0778607	   1e+06     6       12      9	
    4	0.0261744  0.00114023	  0.0250341	   1e+06     6       12      9	
    -3	-0.0768977 0.000244873	  -0.0771426   1e+06     6       12      9	
    -4	-0.0231218 0.000417746	  -0.0235396   1e+06     6   	 12      9	
    3	0.178293   0.000813032	  0.17748      1e+06     6       13      10	
    4	0.0724307	0.000264958	  0.0721658	   1e+06 	 6       13      10	
    -3	-0.176143	-0.000784173  -0.175359	   1e+06 	 6       13      10	
    -4	-0.0690765	-0.00108741	  -0.0679891   1e+06     6       13  	 10	
    3	0.000719665	0.000719665	  -5.70828e-13 1e+06     7       8       11	
    4	-0.170387	0.00124251	  -0.17163	   1e+06     7   	 8       11	
    -3	0.00175901	0.00175901	  5.70828e-13  1e+06     7       8   	 11	
    -4	0.176915	0.000680668   0.176235	   1e+06     7       8       11	
    3	0.280286	-0.000455819  0.280742	   1e+06     7       9       12	
    4	0.0592711	0.00148419	  0.0577869	   1e+06     7       9       12	
    -3	-0.280562	0.000180116	  -0.280742	   1e+06 	 7       9       12	
    -4	-0.0515991	-0.00183288	  -0.0497662   1e+06     7       9   	 12	
    3	0.0532881	0.00101259	  0.0522755	   1e+06     9   	 10      13	
    4	0.0436157	0.00142429	  0.0421914	   1e+06     9       10      13	
    -3	-0.0529742	-0.000827457  -0.0521468   1e+06     9       10  	 13	
    -4	-0.042179	-0.000329658  -0.0418494   1e+06     9       10      13	
    3	0.0951408	0.000877024	  0.0942638	   1e+06     9       14      14	
    4	0.0366394	0.000539298	  0.0361001	   1e+06     9       14      14	
    -3	-0.0933546	-0.00025236	  -0.0931023   1e+06     9       14      14	
    -4	-0.0330336	0.000595665	  -0.0336293   1e+06     9       14  	 14	
    3	-0.0381433	-0.000290044  -0.0378532   1e+06     10      11      15	
    4	-0.0145249	0.00162576	  -0.0161506   1e+06     10      11  	 15	
    -3	0.039288	0.00130901	  0.037979	   1e+06     10  	 11  	 15	
    -4	0.0163496	-9.55607e-05  0.0164451	   1e+06     10  	 11  	 15	
    3	0.0145647	-0.00157783	  0.0161426	   1e+06     12      13      16	
    4	0.0073065	-0.000233093  0.00753959   1e+06     12      13      16	
    -3	-0.018458	-0.00237838   -0.0160796   1e+06     12      13      16	
    -4	-0.00787189	-0.000389278  -0.00748261  1e+06     12      13  	 16	
    3	0.0562876	-0.000150881  0.0564385	   1e+06 	 13      14      17	
    4	0.017868	0.000396251	  0.0174717	   1e+06     13      14      17	
    -3	-0.0561795	-0.000281788  -0.0558977   1e+06     13      14      17	
    -4	-0.0150365	0.00133418	  -0.0163707   1e+06 	 13      14      17	
    3	0.283498	0.00275584	  0.280742	   1e+06 	 4       7       18	
    4	-0.0962982	0.000512411	  -0.0968107   1e+06     4       7   	 18	
    -3	-0.280956	-0.000213831  -0.280742	   1e+06 	 4       7       18	
    -4	0.113756	-8.68003e-05  0.113843	   1e+06     4       7 		 18	
    3	0.159304	-0.00149333	  0.160798	   1e+06     4       9       19	
    4	-0.00346255	0.000813567	  -0.00427611  1e+06     4       9       19	
    -3	-0.160225	0.000572611	  -0.160798	   1e+06     4       9   	 19	
    -4	0.0160206	-0.00130261	  0.0173232	   1e+06 	 4       9       19	
    3	0.440451	-0.000421989  0.440873	   1e+06     5       6       20	
    4	0.127422	0.00271547	  0.124707	   1e+06     5       6       20	
    -3	-0.440588	0.000284908	  -0.440873	   1e+06     5       6       20	
    -4	-0.0802986	0.00019656	  -0.0804952   1e+06     5       6       20	
];
%% 潮流计算结果
pfresult=[   
1	1.060000	0.000000
2	1.045000	-4.982589
3	1.010000	-12.725100
4	1.017671	-10.312901
5	1.019514	-8.773854
6	1.070000	-14.220946
7	1.061520	-13.359627
8	1.090000	-13.359627
9	1.055932	-14.938521
10	1.050985	-15.097288
11	1.056907	-14.790622
12	1.055189	-15.075585
13	1.050382	-15.156276
14	1.035530	-16.033645
];